<!doctype html>
<title>{% block title %}{% endblock %} - Flaskr</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Kanit&family=Montserrat&family=Open+Sans:wght@500&display=swap"
    rel="stylesheet">

<body>
    <div class="full-body-container">
        <div class="top-text">
            <div class="google-colors">
                <h1 id="google-4">B</h1>
                <h1 id="google-3">O</h1>
                <h1 id="google-0-1">O</h1>
                <h1 id="google-0-2">K</h1>
                <h1 id="google-4">H</h1>
                <h1 id="google-3">U</h1>
                <h1 id="google-0-1">B</h1>

            </div>
            <div class="input-box" onclick="sendFocus()">
                <img src="{{ url_for('static', filename='images/mag.png') }}" />
                <!-- adapted from https://dev.to/codingnepal/search-bar-with-autocomplete-search-suggestions-in-javascript-32dn -->
                <div class="wrapper">
                    <div class="search-input">
                      <a href="" target="_blank" hidden></a>
                      <input type="text" placeholder="Search for your next read..." />
                      <div class="autocom-box">
                        <!-- here list are inserted from javascript -->
                      </div>
                    </div>
                  </div>
            </div>
        </div>
        <div id="suggestions"></div>
        <div id="answer-box"></div>
        
    </div>

    <script src="backend/static/script.js"> </script>

    <script>

        function answerBoxTemplate(title, description, score) {
            return `
            <div class='recommendation-container'>
                <h3 class='book-title'>${title}</h3>
                <p class='book-description'>${description}</p>
                <p class='book-review-score'>Review Score: ${score}</p>
            </div>`;
        }

        function sendFocus() {
            document.getElementById('filter-text-val').focus()
        }

        function filterText(event) {
            if (event.keyCode === 13) { // Check if the key pressed is 'Enter'
                let searchText = document.getElementById("filter-text-val").value.trim();
                if (searchText !== "") {
                    fetch("/books?" + new URLSearchParams({ title: searchText }).toString())
                        .then((response) => response.json())
                        .then((data) => {
                            document.getElementById("answer-box").innerHTML = "";
                            data.slice(0, 5).forEach(row => {
                                let tempDiv = document.createElement("div");
                                tempDiv.innerHTML = answerBoxTemplate(row.Title, row.descript, row.review_score);
                                document.getElementById("answer-box").appendChild(tempDiv);
                            });
                        });
                }
            }
        }
    </script>
</body>